{% extends "base.html" %}
{% load static %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Главная</a></li>
        <li class="breadcrumb-item"><a href="{% url 'post_list' %}">Блог</a></li>
        <li class="breadcrumb-item active">{{ post.title|truncatechars:30 }}</li>
    </ol>
</nav>

<article class="post">
    <header class="mb-4">
        <div class="post-meta mb-3">
            <span><i class="far fa-calendar-alt"></i> {{ post.published_date|date:"d.m.Y" }}</span>
            <span><i class="far fa-user"></i> {{ post.author }}</span>
            <span><i class="far fa-eye"></i> {{ post.views }} просмотров</span>
        </div>
        
        <h1>{{ post.title }}</h1>
        
        <div class="mt-3">
            {% for tag in post.tags.all %}
            <span class="badge" style="background-color: var(--secondary); color: white; padding: 5px 10px; border-radius: 50px; font-size: 0.8rem; margin-right: 5px;">
                {{ tag.name }}
            </span>
            {% endfor %}
        </div>
    </header>
    
    <div class="post-content">
        <div class="post-media mb-4">
            {% if post.media_file %}
                {% if post.media_type == 'video' %}
                <div class="video-container">
                    <video class="media-content" autoplay loop muted playsinline controls>
                        <source src="{{ post.media_file.url }}" type="video/mp4">
                        <source src="{{ post.media_file.url }}" type="video/webm">
                        Ваш браузер не поддерживает видео.
                    </video>
                </div>
                {% else %}
                <img src="{{ post.media_file.url }}" 
                    alt="Медиа-контент" 
                    class="media-content {% if post.media_type == 'gif' %}gif-media{% endif %}"
                    {% if post.media_type == 'gif' %}loading="eager"{% endif %}>
                {% endif %}
            {% endif %}
        </div>
        
        {{ post.text|linebreaks }}
        
        <blockquote class="blockquote mt-4 mb-4 p-4" style="border-left: 4px solid var(--primary); background-color: var(--card-bg); border-radius: var(--border-radius);">
            <p style="margin-left: 2%;">{{ post.content }}</p>
        </blockquote>
    </div>
    
    <footer class="mt-5 pt-4 border-top" style="border-color: var(--dark-accent) !important;">
        <div class="d-flex justify-content-between">
            <div>
                <h4>Поделиться:</h4>
                <div class="social-share mt-2">
                    <a href="#" class="btn btn-outline mr-2"><i class="fab fa-vk"></i> ВКонтакте</a>
                    <a href="#" class="btn btn-outline mr-2"><i class="fab fa-telegram"></i> Telegram</a>
                </div>
            </div>
            
            <div class="author-card">
                <div class="author-card-info">
                    <h4>Автор</h4>
                    <img src="{{ post.author.profile.image.url }}" alt="Автор" class="rounded-circle" width="60" height="60" style="object-fit: cover;">
                    <small class="text-muted">@{{ post.author.username }}</small>
                    <h5 class="author-fullname">{{ post.author.get_full_name }}</h5>
                    <p class="text-muted mb-0">{{ post.author.profile.bio|truncatechars:60 }}</p>
                </div>
            </div>
        </div>
    </footer>
</article>

<section class="comments mt-5">
    <h3>Комментарии (3)</h3>
    
    <div class="card mt-3">
        <div class="card-body">
            <div class="d-flex mb-3">
                <img src="/static/images/avatar2.jpg" alt="Пользователь" class="rounded-circle mr-3" width="40">
                <div>
                    <h5 class="mb-0">Алексей Петров</h5>
                    <small class="text-muted">2 дня назад</small>
                </div>
            </div>
            <p>Отличная статья! Особенно понравился раздел про психологию цветовосприятия. Жду продолжения на эту тему.</p>
        </div>
    </div>
    
    <form class="mt-4">
        <div class="form-group">
            <label for="comment" class="form-label">Оставить комментарий</label>
            <textarea class="form-control" id="comment" rows="3" placeholder="Ваши мысли..."></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Отправить</button>
    </form>
</section>
{% endblock %}